<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="BaseComponent" href="api/component/basecomponent.html" /><link rel="prev" title="ComponentMixture" href="api/mixture/componentmixture.html" />

    <meta name="generator" content="sphinx-5.2.1, furo 2022.09.15"/>
        <title>Component Guide - chronostar-dev 2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=9ec31e2665bf879c1d47d93a8ec4893870ee1e45" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">chronostar-dev 2.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">chronostar-dev 2.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="generaloverview.html">General Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="driverguide.html">Driver Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/driver.html">Driver</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="mixtureguide.html">Mixture Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/mixture/chronbasemixture.html">ChronBaseMixture</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/mixture/componentmixture.html">ComponentMixture</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#">Component Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/component/basecomponent.html">BaseComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/component/spacecomponent.html">SpaceComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/component/spacetimecomponent.html">SpaceTimeComponent</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="icpoolguide.html">Initial Conditions Pool Guide</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/icpool/baseicpool.html">BaseICPool</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/icpool/simpleicpool.html">SimpleICPool</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="introducerguide.html">Introducer Guide</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/introducer/baseintroducer.html">BaseIntroudcer</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/introducer/simpleintroducer.html">SimpleIntroducer</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="component-guide">
<h1>Component Guide<a class="headerlink" href="#component-guide" title="Permalink to this heading">#</a></h1>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">API:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/component/basecomponent.html">BaseComponent</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/component/spacecomponent.html">SpaceComponent</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/component/spacetimecomponent.html">SpaceTimeComponent</a></li>
</ul>
</div>
<p>A Component object encapsulates the current estimated parameters and the methods required to fit to data.</p>
<p>For example, a <a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent" title="SpaceTimeComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeComponent</span></code></a> would store its weight (a.k.a. amplitude), age, initial mean and initial covariance matrix. It would also have methods for calculating the log probability of stars <a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent.estimate_log_prob" title="SpaceTimeComponent.estimate_log_prob"><code class="xref py py-func docutils literal notranslate"><span class="pre">estimate_log_prob()</span></code></a> and fitting its parameters <a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent.maximize" title="SpaceTimeComponent.maximize"><code class="xref py py-func docutils literal notranslate"><span class="pre">maximize()</span></code></a>. It also has an <a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent._project_orbit" title="SpaceTimeComponent._project_orbit"><code class="xref py py-func docutils literal notranslate"><span class="pre">_project_orbit()</span></code></a> method for calculating orbits. If a user wishes to use a custom orbit method, they could write a new class that inherits form <a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent" title="SpaceTimeComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeComponent</span></code></a> and override the <code class="xref py py-func docutils literal notranslate"><span class="pre">_project_orbit()</span></code> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The intention is to not differentiate between <em>Background</em> components and <em>stellar association</em> components. The difference will be implicit in the components’ parameterization and fitting method. For example, an association component could have an age parameter, where as a background component would have none. Some other methods could be employed such as enforcing a large minimum position spread for background components and a small minimum position spread for association components. If one wishes to get fancy, one could choose to implement a <a class="reference internal" href="api/introducer/baseintroducer.html#BaseIntroducer" title="BaseIntroducer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseIntroducer</span></code></a> which can convert background components to association components and vica verse, based on some “failure” criteria.</p>
</div>
<div class="section" id="age-fitting-with-a-twist">
<h2>Age fitting with a twist<a class="headerlink" href="#age-fitting-with-a-twist" title="Permalink to this heading">#</a></h2>
<p>In this section I explain how we can implement a Component class that reproduce the same fitting power of Paper I and II components, but with only one free parameter (age), thereby drastically simplifying (and hence speeding up) parameter maximization.</p>
<p>If we ignore data uncertainties, the age is the only free parameter in the maximisation step. To explain this further, consider no age parameter (or equivalently fixing the age at 0). In this case we could use <cite>sklearn.mixture.GaussianMixture</cite> out of the box. There is no parameter exploration needed, because the maximisation step estimates the mean <span class="math notranslate nohighlight">\(\mu_c'\)</span> and covariance <span class="math notranslate nohighlight">\(\Sigma_c'\)</span> through dot products and element-wise arithematic. I use <span class="math notranslate nohighlight">\('\)</span> to denote values calculated or infered from the data without any parameter maximization.</p>
<p><a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent" title="SpaceTimeComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeComponent</span></code></a> introduces a free age parameter <span class="math notranslate nohighlight">\(t\)</span> to a component. Lets say we go ahead and calculate <span class="math notranslate nohighlight">\(\mu_c'\)</span> and <span class="math notranslate nohighlight">\(\Sigma_c'\)</span> like above. The key remaining <strong>time dependent</strong> parameters of a component are its initial mean <span class="math notranslate nohighlight">\(\mu_0\)</span> and initial covariance matrix <span class="math notranslate nohighlight">\(\Sigma_0\)</span>. <span class="math notranslate nohighlight">\(\mu_0\)</span> is constrained completely by the age and data, since we just project <span class="math notranslate nohighlight">\(\mu_c'\)</span> back in time by <span class="math notranslate nohighlight">\(t\)</span>. From similar logic, <span class="math notranslate nohighlight">\(\mu_c\)</span> is constrained completely by the data and <span class="math notranslate nohighlight">\(\mu_c = \mu_c'\)</span>. <span class="math notranslate nohighlight">\(\Sigma_0\)</span> is less apparent, but with some assumptions can be equally constrained. We have <span class="math notranslate nohighlight">\(\Sigma_c'\)</span> from the assigned members. We project this back in time by <span class="math notranslate nohighlight">\(t\)</span> (e.g. by using a Jacobian). We now have a <span class="math notranslate nohighlight">\(\Sigma_0'\)</span>.</p>
<p><span class="math notranslate nohighlight">\(\Sigma_0'\)</span> cannot actually represent the origin of an association, because it may have position-velocity correlations imprinted by the time projection that are unrealistic for an unbound stellar association.</p>
<p>Therefore the penultimate step is to impose the core assumptions of a Component - e.g. that there is no positional-velocity correlation - and impose assumptions specific to the chosen component class - e.g. the <code class="xref py py-class docutils literal notranslate"><span class="pre">SphereComponent</span></code> assumes spherical in position space and spherical in velocity space. Therefore in this case we can derive <span class="math notranslate nohighlight">\(\Sigma_0\)</span> by finding the total space-volume of <span class="math notranslate nohighlight">\(\Sigma_0'\)</span> and inferring the required radius of an equal volume sphere in position space. With similar treatment we can derive the radius in velocity space.</p>
<p>The final step would be to project <span class="math notranslate nohighlight">\(\Sigma_0\)</span> forward by <span class="math notranslate nohighlight">\(t\)</span> to attain <span class="math notranslate nohighlight">\(\Sigma_c\)</span>, a covariance matrix centred on <span class="math notranslate nohighlight">\(\mu_c\)</span>, that matches the extent and shape of <span class="math notranslate nohighlight">\(\Sigma_c'\)</span> as closely as possible, but with the appropriate position-velocity correlations imprinted by <span class="math notranslate nohighlight">\(t\)</span> Myrs of unbound dispersal through the Galaxy. In relevant log probability calculations, <a class="reference internal" href="api/component/spacetimecomponent.html#SpaceTimeComponent" title="SpaceTimeComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpaceTimeComponent</span></code></a> would use <span class="math notranslate nohighlight">\(\mu_c\)</span> and <span class="math notranslate nohighlight">\(\Sigma_c\)</span>.</p>
<p>Hence, <span class="math notranslate nohighlight">\(\mu_0\)</span> and <span class="math notranslate nohighlight">\(\Sigma_0\)</span> are constrained completely by the data and by the age parameter <span class="math notranslate nohighlight">\(t\)</span>. Therefore, any parameter exploration or maximisation approach need only explore one (easily charecterisable) parameter.</p>
</div>
<div class="section" id="example-spacetimecomponent-usage">
<h2>Example SpaceTimeComponent Usage<a class="headerlink" href="#example-spacetimecomponent-usage" title="Permalink to this heading">#</a></h2>
<p>A simple usage will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resp</span> <span class="o">=</span> <span class="c1"># ... assume we have responsibilities (i.e. Z or membership probabilites)</span>
<span class="n">X</span> <span class="o">=</span> <span class="c1"># ... assume we have data, array-like with shape (n_samples, n_features)</span>
<span class="n">config_params</span> <span class="o">=</span> <span class="c1"># ... assume we have Component specific config params, e.g. which feature is in which column</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">SpaceTimeComponent</span><span class="p">(</span><span class="n">config_params</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">maximize</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
<span class="n">log_probs</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">estimate_log_prob</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>work out when (and why) <cite>log_resp</cite> is used vs <cite>resp</cite>.</p>
</div>
</div>
<div class="section" id="suggested-spacecomponent-implementation">
<h2>Suggested SpaceComponent implementation<a class="headerlink" href="#suggested-spacecomponent-implementation" title="Permalink to this heading">#</a></h2>
<p>This would effectively be the same as some of the calculation in <cite>sklearn.mixture.GaussianMixture</cite>. The difference is they store weights, means and covariances in the Mixture object itself, and use a module level function to maximize these parameters from the data. In a <a class="reference internal" href="api/component/basecomponent.html#BaseComponent" title="BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a> implementation, each component tracks its own weight, means and covariances, and uses its own method to maximize the parameters.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Perhaps <cite>weight</cite> should be stored in the <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMixture</span></code> implementation…</p>
</div>
<p>These could be done as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">maximize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">log_resp</span><span class="p">):</span>
  <span class="n">resp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_resp</span><span class="p">)</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span>
  <span class="n">diff</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">covariance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">resp</span> <span class="o">*</span> <span class="n">diff</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span> <span class="o">/</span> <span class="n">nk</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
  <span class="bp">self</span><span class="o">.</span><span class="n">prec_chol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_precision_cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariance</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>sklearn.mixture.GaussianMixture</cite> uses the cholesky decomposition of precisions. A precision is the inverse of covariance. For simplicity I duplicate their calcualtions here.</p>
</div>
<p>Estimating the log probability of each sample would be calculated by evaluating the Gaussain at the point of sample:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">estimate_log_prob</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
  <span class="n">log_det</span> <span class="o">=</span> <span class="n">_compute_log_det_cholesky</span><span class="p">(</span><span class="n">precisions_chol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">)</span>

  <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prec_chol</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">prec_chol</span><span class="p">)</span>
  <span class="n">log_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">+</span> <span class="n">log_prob</span><span class="p">)</span> <span class="o">+</span> <span class="n">log_det</span>
</pre></div>
</div>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api/component/basecomponent.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">BaseComponent</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="api/mixture/componentmixture.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">ComponentMixture</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Timothy D. Crundall
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Component Guide</a><ul>
<li><a class="reference internal" href="#age-fitting-with-a-twist">Age fitting with a twist</a></li>
<li><a class="reference internal" href="#example-spacetimecomponent-usage">Example SpaceTimeComponent Usage</a></li>
<li><a class="reference internal" href="#suggested-spacecomponent-implementation">Suggested SpaceComponent implementation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>